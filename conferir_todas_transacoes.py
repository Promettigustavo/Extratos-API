"""
ConferÃªncia COMPLETA de TODAS as 429 transaÃ§Ãµes
Compara linha por linha com o extrato oficial do Santander
PerÃ­odo: 11/11/2025 a 18/11/2025 - MAKENA
"""

import sys
from datetime import datetime

try:
    try:
        from credenciais_bancos import SANTANDER_FUNDOS
    except ImportError:
        from config_credentials import SANTANDER_FUNDOS
    
    from buscar_extratos_bancarios import SantanderExtratosBancarios
    print("âœ… MÃ³dulos importados\n")
except ImportError as e:
    print(f"âŒ Erro: {e}")
    sys.exit(1)

FUNDO_ID = "MAKENA"

# ========== DADOS COMPLETOS DO EXTRATO SANTANDER (429 transaÃ§Ãµes) ==========
# Formato: (data, historico, valor)
extrato_santander = [
    # 11/11/2025
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -798606.67),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -500000.00),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -427883.63),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -378892.72),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -315449.05),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -308282.62),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -304020.80),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -292720.08),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -286573.16),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -254463.87),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -232307.35),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -214554.98),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -208427.99),
    ("11/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -188709.56),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -183385.60),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -172300.37),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -172017.67),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -163850.70),
    ("11/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -146176.00),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -110907.90),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -101667.36),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -100962.89),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -66473.82),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -63456.88),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -54472.74),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -52316.52),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -34001.83),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -28043.78),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -26970.15),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -26844.52),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -20774.95),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -19288.40),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -15004.84),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -13305.12),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -13170.58),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -10729.19),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -5216.75),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2127.24),
    ("11/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -525.42),
    ("11/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -33300000.00),
    ("11/11/2025", "PIX RECEBIDO", 16435000.00),
    ("11/11/2025", "TED RECEBIDA", 3787.50),
    ("11/11/2025", "PIX RECEBIDO", 1561.32),
    ("11/11/2025", "PIX RECEBIDO", 4497.83),
    ("11/11/2025", "PIX RECEBIDO", 26318.08),
    ("11/11/2025", "PIX RECEBIDO", 37074.66),
    ("11/11/2025", "PIX RECEBIDO", 81812.72),
    ("11/11/2025", "PIX RECEBIDO", 10273.65),
    ("11/11/2025", "PIX RECEBIDO", 88468.89),
    ("11/11/2025", "PIX RECEBIDO", 291962.31),
    ("11/11/2025", "PIX RECEBIDO", 117936.00),
    ("11/11/2025", "PIX RECEBIDO", 65000.00),
    ("11/11/2025", "PIX RECEBIDO", 581099.65),
    ("11/11/2025", "PIX RECEBIDO", 31290.45),
    ("11/11/2025", "PIX RECEBIDO", 81426.44),
    ("11/11/2025", "PIX RECEBIDO", 36714.23),
    ("11/11/2025", "PIX RECEBIDO", 2649.69),
    ("11/11/2025", "PIX RECEBIDO", 17276.98),
    ("11/11/2025", "PIX RECEBIDO", 23897.39),
    ("11/11/2025", "PIX RECEBIDO", 10228.94),
    ("11/11/2025", "PIX RECEBIDO", 65543.11),
    ("11/11/2025", "PIX RECEBIDO", 444706.66),
    ("11/11/2025", "PIX RECEBIDO", 1589900.00),
    ("11/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 19110396.65),
    ("11/11/2025", "TAR PIX PGTO FORNEC - OUTRA INST", -97.20),
    ("11/11/2025", "TAR PIX PGTO FORNEC - MESMA INST", -7.20),
    ("11/11/2025", "TAR EMISSAO TED CIP PGTO FORNEC", -10.50),
    
    # 12/11/2025 - Total de transaÃ§Ãµes no PDF
    ("12/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -3738184.09),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2287481.93),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -766699.05),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -575811.90),
    ("12/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -517211.41),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -489601.06),
    ("12/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -484394.13),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -399193.33),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -302201.35),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -250000.00),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -222425.72),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -199383.69),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -169653.39),
    ("12/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -169585.62),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -163489.97),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -161737.92),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -155891.16),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -155891.16),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -150831.75),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -131834.41),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -127346.41),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -113948.39),
    ("12/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -102312.19),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -97797.03),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -96138.79),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -75518.22),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -75509.37),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -75273.43),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -71801.50),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -70214.88),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -58975.73),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -56422.06),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -54489.35),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -45514.13),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -44977.03),
    ("12/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -44571.79),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -41788.59),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -40380.25),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -39932.30),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -29146.85),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -27413.82),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -26316.98),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -25273.51),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -23879.61),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -19469.00),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -16467.00),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -14777.41),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -12966.96),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -12159.76),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -11036.19),
    ("12/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -8275.76),
    ("12/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -500000.00),
    ("12/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -32800000.00),
    ("12/11/2025", "DEVOLUCAO DE PIX NAO EFETUADA", 155891.16),
    ("12/11/2025", "PIX RECEBIDO", 1857000.00),
    ("12/11/2025", "PIX RECEBIDO", 58883.32),
    ("12/11/2025", "PIX RECEBIDO", 41387.47),
    ("12/11/2025", "PIX RECEBIDO", 550.00),
    ("12/11/2025", "PIX RECEBIDO", 25773.00),
    ("12/11/2025", "PIX RECEBIDO", 27050.94),
    ("12/11/2025", "PIX RECEBIDO", 26132.48),
    ("12/11/2025", "PIX RECEBIDO", 31631.84),
    ("12/11/2025", "PIX RECEBIDO", 105874.33),
    ("12/11/2025", "PIX RECEBIDO", 22574.34),
    ("12/11/2025", "PIX RECEBIDO", 32249.77),
    ("12/11/2025", "PIX RECEBIDO", 483797.53),
    ("12/11/2025", "PIX RECEBIDO", 68256.45),
    ("12/11/2025", "PIX RECEBIDO", 10765.00),
    ("12/11/2025", "PIX RECEBIDO", 180878.62),
    ("12/11/2025", "PIX RECEBIDO", 36093.00),
    ("12/11/2025", "PIX RECEBIDO", 10748233.61),
    ("12/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 33318294.93),
    ("12/11/2025", "TAR PIX PGTO FORNEC - OUTRA INST", -66.60),
    ("12/11/2025", "TAR PIX PGTO FORNEC - MESMA INST", -3.60),
    
    # 13/11/2025
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -4848713.28),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -1000000.00),
    ("13/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -1000000.00),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -797433.33),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -765051.50),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -672327.88),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -526610.04),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -440484.42),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -406268.28),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -390736.88),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -313468.30),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -288304.48),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -249316.63),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -219378.10),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -216302.62),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -213014.34),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -209663.31),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -208203.29),
    ("13/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -198731.67),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -188440.74),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -172165.32),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -171564.94),
    ("13/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -147911.77),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -123815.03),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -114693.99),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -110402.59),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -99869.63),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -98380.00),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -93236.00),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -92959.70),
    ("13/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -87444.76),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -81281.89),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -68185.57),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -51440.75),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -47687.76),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -44103.06),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -38508.91),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -37293.60),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -28388.88),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -26836.34),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -21643.51),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -20464.95),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -9666.99),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2802.27),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -768.98),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -712.25),
    ("13/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -612.29),
    ("13/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -155.78),
    ("13/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -65000000.00),
    ("13/11/2025", "PIX RECEBIDO", 24801000.00),
    ("13/11/2025", "PIX RECEBIDO", 12000000.00),
    ("13/11/2025", "PIX RECEBIDO", 379845.28),
    ("13/11/2025", "PIX RECEBIDO", 14491.00),
    ("13/11/2025", "PIX RECEBIDO", 141490.35),
    ("13/11/2025", "PIX RECEBIDO", 2767.33),
    ("13/11/2025", "PIX RECEBIDO", 9776.06),
    ("13/11/2025", "PIX RECEBIDO", 14839.10),
    ("13/11/2025", "PIX RECEBIDO", 6346.70),
    ("13/11/2025", "PIX RECEBIDO", 7216.85),
    ("13/11/2025", "PIX RECEBIDO", 1982.80),
    ("13/11/2025", "PIX RECEBIDO", 487856.25),
    ("13/11/2025", "PIX RECEBIDO", 3082.88),
    ("13/11/2025", "PIX RECEBIDO", 215360.01),
    ("13/11/2025", "PIX RECEBIDO", 37556.01),
    ("13/11/2025", "PIX RECEBIDO", 51730.00),
    ("13/11/2025", "PIX RECEBIDO", 15005.78),
    ("13/11/2025", "PIX RECEBIDO", 7578354.49),
    ("13/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 33318145.18),
    ("13/11/2025", "TAR PIX PGTO FORNEC - OUTRA INST", -79.20),
    ("13/11/2025", "TAR PIX PGTO FORNEC - MESMA INST", -10.80),
    ("13/11/2025", "TAR EMISSAO TED CIP PGTO FORNEC", -5.25),
    
    # 14/11/2025
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2628952.31),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2000000.00),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -750000.00),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -534030.89),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -532636.12),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -398606.66),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -394619.23),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -365359.71),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -365301.04),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -359997.87),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -350990.48),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -291175.19),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -278990.02),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -270825.56),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -251076.70),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -251010.71),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -247671.04),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -238183.85),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -236913.56),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -205457.08),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -177287.27),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -160000.00),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -150094.66),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -142221.88),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -136708.44),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -136404.47),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -125175.38),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -116049.74),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -113872.19),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -112188.67),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -111845.93),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -111775.43),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -106865.92),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -97638.66),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -92589.95),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -88302.91),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -74946.90),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -70685.91),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -60356.12),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -57253.25),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -55286.75),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -54862.20),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -53816.58),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -52783.38),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -50263.90),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -48457.76),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -44635.01),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -22312.42),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -21814.25),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -20134.42),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -19613.24),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -19586.48),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -19115.28),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -13286.15),
    ("14/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -13272.05),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -13110.57),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -11820.92),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -10544.90),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -10032.68),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -7570.90),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -5000.00),
    ("14/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -770.63),
    ("14/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 200000.00),
    ("14/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -65000000.00),
    ("14/11/2025", "PIX RECEBIDO", 894000.00),
    ("14/11/2025", "PIX RECEBIDO", 3884.65),
    ("14/11/2025", "PIX RECEBIDO", 2599.10),
    ("14/11/2025", "PIX RECEBIDO", 7322.84),
    ("14/11/2025", "PIX RECEBIDO", 213782.05),
    ("14/11/2025", "PIX RECEBIDO", 353092.48),
    ("14/11/2025", "PIX RECEBIDO", 2578.70),
    ("14/11/2025", "PIX RECEBIDO", 40719.56),
    ("14/11/2025", "PIX RECEBIDO", 1200.00),
    ("14/11/2025", "PIX RECEBIDO", 80409.09),
    ("14/11/2025", "PIX RECEBIDO", 76916.67),
    ("14/11/2025", "PIX RECEBIDO", 1312.40),
    ("14/11/2025", "PIX RECEBIDO", 81878.85),
    ("14/11/2025", "PIX RECEBIDO", 2852.32),
    ("14/11/2025", "PIX RECEBIDO", 44938.98),
    ("14/11/2025", "PIX RECEBIDO", 6132.04),
    ("14/11/2025", "PIX RECEBIDO", 4029.79),
    ("14/11/2025", "PIX RECEBIDO", 102441.25),
    ("14/11/2025", "PIX RECEBIDO", 186910.70),
    ("14/11/2025", "PIX RECEBIDO", 11375540.15),
    ("14/11/2025", "PIX RECEBIDO", 94219.65),
    ("14/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 65035114.34),
    ("14/11/2025", "TAR PIX PGTO FORNEC - OUTRA INST", -77.40),
    ("14/11/2025", "TAR PIX PGTO FORNEC - MESMA INST", -9.00),
    
    # 17/11/2025
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -7115721.29),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2920998.94),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2618277.33),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2225137.42),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -1929904.77),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -1325563.15),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -798606.67),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -780000.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -702496.43),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -600343.44),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -575734.98),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -435195.99),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -384803.31),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -343800.83),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -331116.74),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -320000.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -316704.06),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -286491.04),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -283567.23),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -256720.09),
    ("17/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -251175.06),
    ("17/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -250131.90),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -250000.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -227935.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -225646.34),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -221540.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -217936.97),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -211034.25),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -196710.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -180466.56),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -177124.91),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -175334.01),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -157511.77),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -151152.98),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -150000.00),
    ("17/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -146865.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -136783.78),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -131876.62),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -122607.64),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -115126.90),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -112089.00),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -106256.78),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -105558.40),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -97859.42),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -96844.59),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -96339.26),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -84267.34),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -79915.49),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -75210.59),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -71020.29),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -68196.83),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -58541.84),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -54418.32),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -53251.82),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -52666.15),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -52285.44),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -49773.93),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -42791.58),
    ("17/11/2025", "PAGFOR PIX MESMA INST-DIFERENT TIT", -41963.66),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -41427.72),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -37273.04),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -37022.91),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -29217.66),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -26824.40),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -23878.27),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -21846.26),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -21620.12),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -20285.75),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -14873.54),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -7213.70),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -6437.71),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -5740.28),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -5210.18),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -3597.45),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -2629.18),
    ("17/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -176.73),
    ("17/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -400000.00),
    ("17/11/2025", "APLIC DI TITULOS PUBLICOS PREMIUM", -48500000.00),
    ("17/11/2025", "PIX RECEBIDO", 6859000.00),
    ("17/11/2025", "PIX RECEBIDO", 48668.83),
    ("17/11/2025", "PIX RECEBIDO", 12142.92),
    ("17/11/2025", "PIX RECEBIDO", 40520.40),
    ("17/11/2025", "PIX RECEBIDO", 15510.91),
    ("17/11/2025", "PIX RECEBIDO", 213354.65),
    ("17/11/2025", "PIX RECEBIDO", 38151.26),
    ("17/11/2025", "PIX RECEBIDO", 145251.43),
    ("17/11/2025", "PIX RECEBIDO", 11627.63),
    ("17/11/2025", "PIX RECEBIDO", 84252.82),
    ("17/11/2025", "PIX RECEBIDO", 14962.48),
    ("17/11/2025", "PIX RECEBIDO", 1371.50),
    ("17/11/2025", "PIX RECEBIDO", 13196.27),
    ("17/11/2025", "PIX RECEBIDO", 10407.00),
    ("17/11/2025", "PIX RECEBIDO", 46683.81),
    ("17/11/2025", "PIX RECEBIDO", 58026.67),
    ("17/11/2025", "PIX RECEBIDO", 9395.87),
    ("17/11/2025", "PIX RECEBIDO", 3267.81),
    ("17/11/2025", "PIX RECEBIDO", 17915.00),
    ("17/11/2025", "PIX RECEBIDO", 6558.65),
    ("17/11/2025", "PIX RECEBIDO", 6501957.24),
    ("17/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 64835133.35),
    ("17/11/2025", "TAR PIX PGTO FORNEC - OUTRA INST", -97.20),
    ("17/11/2025", "TAR PIX PGTO FORNEC - MESMA INST", -12.60),
    ("17/11/2025", "TAR EMISSAO TED CIP PGTO FORNEC", -5.25),
    
    # 18/11/2025
    ("18/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -773388.35),
    ("18/11/2025", "PIX RECEBIDO", 17428.23),
    ("18/11/2025", "PIX RECEBIDO", 14316.45),
    ("18/11/2025", "PIX RECEBIDO", 27391.23),
    ("18/11/2025", "PIX RECEBIDO", 6363.33),
    ("18/11/2025", "PIX RECEBIDO", 4262.00),
    ("18/11/2025", "PIX RECEBIDO", 11276.00),
    ("18/11/2025", "PIX RECEBIDO", 272907.67),
    ("18/11/2025", "PIX RECEBIDO", 2131653.43),
    ("18/11/2025", "PIX RECEBIDO", 222275.90),
    ("18/11/2025", "PIX RECEBIDO", 80471.41),
    ("18/11/2025", "PIX RECEBIDO", 4431.54),
    ("18/11/2025", "PIX RECEBIDO", 40137.88),
    ("18/11/2025", "PIX RECEBIDO", 476367.01),
    ("18/11/2025", "PIX RECEBIDO", 54190.55),
    ("18/11/2025", "PIX RECEBIDO", 12464.36),
    ("18/11/2025", "PIX RECEBIDO", 10023.40),
    ("18/11/2025", "PIX RECEBIDO", 24684.99),
    ("18/11/2025", "PIX RECEBIDO", 26855.96),
    ("18/11/2025", "PAGFOR PIX OUTRA INST- DIFEREN TIT", -398900.00),
    ("18/11/2025", "PIX RECEBIDO", 18375458.14),
    ("18/11/2025", "RESGATE FUNDO DE INVESTIMENTO", 48926666.13),
    ("18/11/2025", "PIX RECEBIDO", 385714.00),
    ("18/11/2025", "TAR PIX PGTO FORNEC - OUTRA INST", -127.80),
    ("18/11/2025", "TAR PIX PGTO FORNEC - MESMA INST", -7.20),
    ("18/11/2025", "TAR EMISSAO TED CIP PGTO FORNEC", -5.25),
]

print("=" * 140)
print("CONFERÃŠNCIA COMPLETA - TODAS AS 429 TRANSAÃ‡Ã•ES")
print("MAKENA | 11/11/2025 a 18/11/2025")
print("=" * 140)

# Buscar dados da API
client = SantanderExtratosBancarios(FUNDO_ID)
data_inicial = datetime(2025, 11, 11)
data_final = datetime(2025, 11, 18)

print(f"\nğŸ”„ Buscando transaÃ§Ãµes da API...\n")

try:
    transacoes = client.buscar_transacoes(
        branch_code="2271",
        account_number="000130107983",
        data_inicial=data_inicial,
        data_final=data_final
    )
    
    saldo_info = client.buscar_saldo(
        branch_code="2271",
        account_number="000130107983"
    )
    
    # Ordenar transaÃ§Ãµes
    def extrair_data_ordenacao(trans):
        data = trans.get('transactionDate', '')
        if data and len(data) >= 10:
            try:
                return datetime.strptime(data[:10], '%d/%m/%Y')
            except:
                try:
                    return datetime.strptime(data[:10], '%Y-%m-%d')
                except:
                    return datetime(9999, 12, 31)
        return datetime(9999, 12, 31)
    
    transacoes_ordenadas = sorted(transacoes, key=extrair_data_ordenacao)
    
    print(f"âœ… API: {len(transacoes_ordenadas)} transaÃ§Ãµes")
    print(f"âœ… Santander: {len(extrato_santander)} transaÃ§Ãµes\n")
    
    # ========== CONFERÃŠNCIA LINHA POR LINHA ==========
    print("=" * 140)
    print("CONFERÃŠNCIA DETALHADA (mostrando apenas divergÃªncias, se houver):")
    print("=" * 140)
    
    divergencias = []
    conferencias_ok = 0
    
    for i, (data_sant, hist_sant, valor_sant) in enumerate(extrato_santander, 1):
        if i - 1 < len(transacoes_ordenadas):
            trans_api = transacoes_ordenadas[i - 1]
            data_api = trans_api.get('transactionDate', '')
            hist_api = trans_api.get('transactionName', '')
            valor_api_raw = float(trans_api.get('amount', 0))
            tipo_api = trans_api.get('creditDebitType', '')
            
            # Aplicar sinal
            if tipo_api == 'DEBITO':
                valor_api = -abs(valor_api_raw)
            else:
                valor_api = abs(valor_api_raw)
            
            # Verificar match
            match_data = data_api == data_sant
            match_valor = abs(valor_api - valor_sant) < 0.01
            
            if match_data and match_valor:
                conferencias_ok += 1
            else:
                divergencias.append({
                    'linha': i,
                    'data_sant': data_sant,
                    'data_api': data_api,
                    'hist_sant': hist_sant,
                    'hist_api': hist_api,
                    'valor_sant': valor_sant,
                    'valor_api': valor_api,
                    'match_data': match_data,
                    'match_valor': match_valor
                })
    
    # Mostrar resultado
    if not divergencias:
        print(f"""
ğŸ¯ RESULTADO: PERFEITO!

   âœ… TODAS as {conferencias_ok} transaÃ§Ãµes conferem 100%!
   
   â€¢ Data: TODAS CORRETAS
   â€¢ Valor: TODOS CORRETOS (centavo por centavo)
   â€¢ Ordem: CORRETA (cronolÃ³gica)
   
   Nenhuma divergÃªncia encontrada!
""")
    else:
        print(f"\nâš ï¸  DIVERGÃŠNCIAS ENCONTRADAS: {len(divergencias)}\n")
        print(f"{'Linha':<6} | {'Data Sant':<12} | {'Data API':<12} | {'Valor Sant':>18} | {'Valor API':>18} | {'Status':<10}")
        print("-" * 140)
        
        for div in divergencias:
            status = ""
            if not div['match_data']:
                status += "âŒDATA "
            if not div['match_valor']:
                status += "âŒVALOR"
            if div['match_data'] and div['match_valor']:
                status = "âœ…OK"
            
            print(f"{div['linha']:<6} | {div['data_sant']:<12} | {div['data_api']:<12} | R$ {div['valor_sant']:>15,.2f} | R$ {div['valor_api']:>15,.2f} | {status:<10}")
        
        print(f"\nâœ… TransaÃ§Ãµes corretas: {conferencias_ok}/{len(extrato_santander)}")
        print(f"âŒ DivergÃªncias: {len(divergencias)}/{len(extrato_santander)}")
    
    # ========== RESUMO FINAL ==========
    print("\n" + "=" * 140)
    print("RESUMO FINAL:")
    print("=" * 140)
    
    saldo_atual = float(saldo_info.get('availableAmount', 0))
    saldo_anterior_santander = 488571.24
    saldo_final_santander = 70190470.74
    
    # Calcular totais
    total_creditos = sum(abs(v) for _, _, v in extrato_santander if v > 0)
    total_debitos = sum(abs(v) for _, _, v in extrato_santander if v < 0)
    total_liquido = total_creditos - total_debitos
    saldo_anterior_calc = saldo_atual - total_liquido
    
    print(f"""
ğŸ“Š ValidaÃ§Ã£o Completa:
   
   Saldo Anterior (Santander): R$ {saldo_anterior_santander:>20,.2f}
   Saldo Anterior (Calculado): R$ {saldo_anterior_calc:>20,.2f}
   DiferenÃ§a:                  R$ {abs(saldo_anterior_calc - saldo_anterior_santander):>20,.2f}  {'âœ…' if abs(saldo_anterior_calc - saldo_anterior_santander) < 0.01 else 'âŒ'}
   
   Saldo Final (Santander):    R$ {saldo_final_santander:>20,.2f}
   Saldo Final (API):          R$ {saldo_atual:>20,.2f}
   DiferenÃ§a:                  R$ {abs(saldo_atual - saldo_final_santander):>20,.2f}  {'âœ…' if abs(saldo_atual - saldo_final_santander) < 0.01 else 'âŒ'}
   
   Total CrÃ©ditos:             R$ {total_creditos:>20,.2f}
   Total DÃ©bitos:              R$ {total_debitos:>20,.2f}
   Total LÃ­quido:              R$ {total_liquido:>20,.2f}
   
   TransaÃ§Ãµes Conferidas:      {conferencias_ok}/{len(extrato_santander)}  {'âœ… 100%' if conferencias_ok == len(extrato_santander) else f'âš ï¸ {conferencias_ok/len(extrato_santander)*100:.1f}%'}
""")
    
    print("=" * 140)
    
except Exception as e:
    print(f"âŒ Erro: {e}")
    import traceback
    traceback.print_exc()
